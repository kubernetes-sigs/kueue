# TAS Performance Test Configuration
#
# Matches the baseline structure (5 cohorts × 6 queues × 500 workloads = 15,000 total)
# for direct comparison of TAS overhead vs baseline scheduling.
#
# Topology: 1 block × 10 racks × 64 nodes = 640 nodes total
# Workload patterns: Required, Preferred, and Balanced topology

# Topology configuration
topology:
  name: "default-topology"
  levels:
    - name: block
      count: 1
      nodeLabel: "cloud.provider.com/topology-block"
    - name: rack
      count: 10
      nodeLabel: "cloud.provider.com/topology-rack"
    - name: node
      count: 64
      nodeLabel: "kubernetes.io/hostname"
      capacity:
        cpu: "96"
        memory: "256Gi"

# Resource flavor configuration
resourceFlavor:
  name: "tas-flavor"
  nodeLabel: "tas-node-group"
  topologyName: "default-topology"

# Workload generation matched to baseline: 5 cohorts × 6 queues × 500 workloads = 15,000 total
# Cluster capacity: 640 nodes × 96 CPU = 61,440 CPU
cohorts:
  - className: cohort
    count: 5
    queuesSets:
    - className: cq
      count: 6
      nominalQuota: "20"
      borrowingLimit: "100"
      reclaimWithinCohort: Any
      withinClusterQueue: LowerPriority
      workloadsSets:
      # Small workloads: 2 pods × 500m = 1 CPU per workload (matches baseline: 1 CPU)
      # 120 + 120 + 110 = 350 total
      - count: 120
        creationIntervalMs: 100
        workloads:
        - className: small-required-rack
          runtimeMs: 200
          priority: 50
          request: "500m"
          podCount: 2
          tasConstraint: "required"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 120
        creationIntervalMs: 100
        workloads:
        - className: small-preferred-rack
          runtimeMs: 200
          priority: 50
          request: "500m"
          podCount: 2
          tasConstraint: "preferred"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 110
        creationIntervalMs: 100
        workloads:
        - className: small-balanced-rack
          runtimeMs: 200
          priority: 50
          request: "500m"
          podCount: 2
          tasConstraint: "balanced"
          tasLevel: "cloud.provider.com/topology-rack"
          sliceSize: 1

      # Medium workloads: 4 pods × 1250m = 5 CPU per workload (matches baseline: 5 CPU)
      # 34 + 33 + 33 = 100 total
      - count: 34
        creationIntervalMs: 500
        workloads:
        - className: medium-required-rack
          runtimeMs: 500
          priority: 100
          request: "1250m"
          podCount: 4
          tasConstraint: "required"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 33
        creationIntervalMs: 500
        workloads:
        - className: medium-preferred-rack
          runtimeMs: 500
          priority: 100
          request: "1250m"
          podCount: 4
          tasConstraint: "preferred"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 33
        creationIntervalMs: 500
        workloads:
        - className: medium-balanced-rack
          runtimeMs: 500
          priority: 100
          request: "1250m"
          podCount: 4
          tasConstraint: "balanced"
          tasLevel: "cloud.provider.com/topology-rack"
          sliceSize: 2

      # Large workloads: 8 pods × 2500m = 20 CPU per workload (matches baseline: 20 CPU)
      # 17 + 17 + 16 = 50 total
      - count: 17
        creationIntervalMs: 1200
        workloads:
        - className: large-required-rack
          runtimeMs: 1000
          priority: 200
          request: "2500m"
          podCount: 8
          tasConstraint: "required"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 17
        creationIntervalMs: 1200
        workloads:
        - className: large-preferred-rack
          runtimeMs: 1000
          priority: 200
          request: "2500m"
          podCount: 8
          tasConstraint: "preferred"
          tasLevel: "cloud.provider.com/topology-rack"

      - count: 16
        creationIntervalMs: 1200
        workloads:
        - className: large-balanced-rack
          runtimeMs: 1000
          priority: 200
          request: "2500m"
          podCount: 8
          tasConstraint: "balanced"
          tasLevel: "cloud.provider.com/topology-rack"
          sliceSize: 4
