{{- /*
Copyright The Kubernetes Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/ -}}

{{/* Code generated by yaml-processor. DO NOT EDIT. */}}

{{- $integrationsConfig := (fromYaml .Values.managerConfig.controllerManagerConfigYaml).integrations }}
{{- $managerConfig := (fromYaml .Values.managerConfig.controllerManagerConfigYaml) }}
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  labels:
  {{- include "kueue.labels" . | nindent 4 }}
  name: '{{ include "kueue.fullname" . }}-mutating-webhook-configuration'
  {{- if .Values.enableCertManager }}
  annotations:
    cert-manager.io/inject-ca-from: {{ .Release.Namespace }}/{{ include "kueue.fullname" . }}-serving-cert
  {{- end }}
  namespace: '{{ .Release.Namespace }}'
webhooks:
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-workload-codeflare-dev-v1beta2-appwrapper
    failurePolicy: Fail
    name: mappwrapper.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - workload.codeflare.dev
        apiVersions:
          - v1beta2
        operations:
          - CREATE
        resources:
          - appwrappers
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kueue-x-k8s-io-v1beta2-clusterqueue
    failurePolicy: Fail
    name: mclusterqueue.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
        resources:
          - clusterqueues
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-apps-v1-deployment
    name: mdeployment.kb.io
    {{- if has "deployment" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - apps
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - deployments
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v1-jaxjob
    failurePolicy: Fail
    name: mjaxjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - jaxjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-batch-v1-job
    failurePolicy: Fail
    name: mjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - batch
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - jobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-jobset-x-k8s-io-v1alpha2-jobset
    failurePolicy: Fail
    name: mjobset.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - jobset.x-k8s.io
        apiVersions:
          - v1alpha2
        operations:
          - CREATE
        resources:
          - jobsets
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-leaderworkerset-x-k8s-io-v1-leaderworkerset
    failurePolicy: Fail
    name: mleaderworkerset.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - leaderworkerset.x-k8s.io
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - leaderworkersets
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v2beta1-mpijob
    failurePolicy: Fail
    name: mmpijob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v2beta1
        operations:
          - CREATE
        resources:
          - mpijobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v1-paddlejob
    failurePolicy: Fail
    name: mpaddlejob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - paddlejobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate--v1-pod
    name: mpod.kb.io
    {{- if has "pod" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - ""
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - pods
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v1-pytorchjob
    failurePolicy: Fail
    name: mpytorchjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - pytorchjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-ray-io-v1-raycluster
    failurePolicy: Fail
    name: mraycluster.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - rayclusters
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-ray-io-v1-rayjob
    failurePolicy: Fail
    name: mrayjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - rayjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-ray-io-v1-rayservice
    failurePolicy: Fail
    name: mrayservice.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - rayservices
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kueue-x-k8s-io-v1beta2-resourceflavor
    failurePolicy: Fail
    name: mresourceflavor.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
        resources:
          - resourceflavors
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-apps-v1-statefulset
    name: mstatefulset.kb.io
    {{- if has "statefulset" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - apps
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - statefulsets
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v1-tfjob
    failurePolicy: Fail
    name: mtfjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - tfjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-trainer-kubeflow-org-v1alpha1-trainjob
    failurePolicy: Fail
    name: mtrainjob.kb.io
    rules:
      - apiGroups:
          - trainer.kubeflow.org
        apiVersions:
          - v1alpha1
        operations:
          - CREATE
        resources:
          - trainjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kueue-x-k8s-io-v1beta2-workload
    failurePolicy: Fail
    name: mworkload.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
        resources:
          - workloads
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /mutate-kubeflow-org-v1-xgboostjob
    failurePolicy: Fail
    name: mxgboostjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
        resources:
          - xgboostjobs
    sideEffects: None
    reinvocationPolicy: '{{ .Values.mutatingWebhook.reinvocationPolicy }}'
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  labels:
  {{- include "kueue.labels" . | nindent 4 }}
  name: '{{ include "kueue.fullname" . }}-validating-webhook-configuration'
  {{- if .Values.enableCertManager }}
  annotations:
    cert-manager.io/inject-ca-from: {{ .Release.Namespace }}/{{ include "kueue.fullname" . }}-serving-cert
  {{- end }}
  namespace: '{{ .Release.Namespace }}'
webhooks:
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-workload-codeflare-dev-v1beta2-appwrapper
    failurePolicy: Fail
    name: vappwrapper.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - workload.codeflare.dev
        apiVersions:
          - v1beta2
        operations:
          - CREATE
          - UPDATE
        resources:
          - appwrappers
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kueue-x-k8s-io-v1beta2-clusterqueue
    failurePolicy: Fail
    name: vclusterqueue.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
          - UPDATE
        resources:
          - clusterqueues
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kueue-x-k8s-io-v1beta2-cohort
    failurePolicy: Fail
    name: vcohort.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
          - UPDATE
        resources:
          - cohorts
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-apps-v1-deployment
    name: vdeployment.kb.io
    {{- if has "deployment" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - apps
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - deployments
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v1-jaxjob
    failurePolicy: Fail
    name: vjaxjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - jaxjobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-batch-v1-job
    failurePolicy: Fail
    name: vjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - batch
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - jobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-jobset-x-k8s-io-v1alpha2-jobset
    failurePolicy: Fail
    name: vjobset.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - jobset.x-k8s.io
        apiVersions:
          - v1alpha2
        operations:
          - CREATE
          - UPDATE
        resources:
          - jobsets
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-leaderworkerset-x-k8s-io-v1-leaderworkerset
    failurePolicy: Fail
    name: vleaderworkerset.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - leaderworkerset.x-k8s.io
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - leaderworkersets
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v2beta1-mpijob
    failurePolicy: Fail
    name: vmpijob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v2beta1
        operations:
          - CREATE
          - UPDATE
        resources:
          - mpijobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v1-paddlejob
    failurePolicy: Fail
    name: vpaddlejob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - paddlejobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate--v1-pod
    name: vpod.kb.io
    {{- if has "pod" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - ""
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - pods
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v1-pytorchjob
    failurePolicy: Fail
    name: vpytorchjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - pytorchjobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-ray-io-v1-raycluster
    failurePolicy: Fail
    name: vraycluster.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - rayclusters
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-ray-io-v1-rayjob
    failurePolicy: Fail
    name: vrayjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - rayjobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-ray-io-v1-rayservice
    failurePolicy: Fail
    name: vrayservice.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - ray.io
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - rayservices
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kueue-x-k8s-io-v1beta2-resourceflavor
    failurePolicy: Fail
    name: vresourceflavor.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
          - UPDATE
        resources:
          - resourceflavors
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-apps-v1-statefulset
    name: vstatefulset.kb.io
    {{- if has "statefulset" $integrationsConfig.frameworks }}
    failurePolicy: Fail
    {{- else }}
    failurePolicy: Ignore
    {{- end }}
    namespaceSelector:
      {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") -}}
        {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 -}}
      {{- else }}
      matchExpressions:
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - '{{ .Release.Namespace }}'
      {{- end }}
    rules:
      - apiGroups:
          - apps
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - statefulsets
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v1-tfjob
    failurePolicy: Fail
    name: vtfjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - tfjobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-trainer-kubeflow-org-v1alpha1-trainjob
    failurePolicy: Fail
    name: vtrainjob.kb.io
    rules:
      - apiGroups:
          - trainer.kubeflow.org
        apiVersions:
          - v1alpha1
        operations:
          - CREATE
          - UPDATE
        resources:
          - trainjobs
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kueue-x-k8s-io-v1beta2-workload
    failurePolicy: Fail
    name: vworkload.kb.io
    rules:
      - apiGroups:
          - kueue.x-k8s.io
        apiVersions:
          - v1beta2
        operations:
          - CREATE
          - UPDATE
        resources:
          - workloads
          - workloads/status
    sideEffects: None
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: '{{ include "kueue.fullname" . }}-webhook-service'
        namespace: '{{ .Release.Namespace }}'
        path: /validate-kubeflow-org-v1-xgboostjob
    failurePolicy: Fail
    name: vxgboostjob.kb.io
    {{- if (hasKey $managerConfig "managedJobsNamespaceSelector") }}
    namespaceSelector:
      {{- toYaml $managerConfig.managedJobsNamespaceSelector | nindent 6 }}
    {{- end }}
    rules:
      - apiGroups:
          - kubeflow.org
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - xgboostjobs
    sideEffects: None
